!function(){function t(){var t=new Date;this.focusObj=null,this.shield="[]",this.fixDate={y:t.getFullYear(),m:t.getMonth()+1,d:t.getDate()},this.startDate="",this.startJSON={},this.hours=!1,this.hoursPast=!1,this.init()}function e(t,e){function a(t){function a(t){var a=t.targetTouches?t.targetTouches[0]:t||event;return i=a.pageX-s,y?!1:(Math.abs(i)>=o&&(y=!0,e&&e(l,i)),a.preventDefault&&a.preventDefault(),!1)}function n(){this.ontouchmove&&(this.ontouchmove=null),this.ontouchend&&(this.ontouchend=null),this.onmousemove&&(this.onmousemove=null),this.onmouseup&&(this.onmouseup=null)}var i,r=t.targetTouches?t.targetTouches[0]:t||event,s=r.pageX,o=parseInt(document.documentElement.clientWidth/5,10),l=this;this.ontouchmove=a,this.onmousemove=a,this.ontouchend=n,this.onmouseup=n}t.ontouchstart=a,t.onmousedown=a}function a(t,e,a){if(e){var n=t.className.replace(/\s+/g," ");n=n.split(" "),e=e.replace(/\s+/,""),a=a||"add";for(var i=0;i<n.length;i++)switch(a){case"has":if(e==n[i])return!0;break;case"add":case"remove":e==n[i]&&n.splice(i,1)}"add"==a&&n.push(e),t.className=n.join(" ")}}function n(t,e){var a,n=e.charAt(0);switch(n){case"#":a=t.getElementById(e.substring(1));break;case".":a=t.getElementsByClassName(e.substring(1));break;default:a=t.getElementsByTagName(e)}return a}function i(t,e,a){if(t){e=e||{},a=a||"";var n=document.createElement(t);for(var i in e)n.setAttribute(i,e[i]);return n.innerHTML=a,n}}function r(){a(b,"close"),setTimeout(function(){a(b,"active","remove"),a(b,"close","remove")},290)}function s(t,e){if(!t)return!1;t=t.split("/"),e=e||"y/m/d";for(var a=e.charAt(0),n=0,i=0;i<e.length;i++)a.charAt(n)!=e.charAt(i)&&(a+=e.charAt(i),n++);var r={y:t[0],m:t[1],d:t[2]},s="",o="";/\//g.test(a)?s="/":/\-/g.test(a)&&(s="-"),a=a.split(s);for(var i=0;i<a.length;i++)o+=r[a[i]],i<a.length-1&&(o+=s);return o}function o(t){if(t=t.replace(/[\'\s]+/g,"")){t=t.match(/(\d+[\/\-]\d+[\/\-]\d+)/g);for(var e=[],a=0;a<t.length;a++){var n=t[a].match(/\d+/g),i={};3==n.length?(i.m=n[1],4==n[0].length?(i.y=n[0],i.d=n[2]):(i.d=n[0],i.y=n[2])):2==n.length&&(4==n[0].length?(i.y=n[0],i.m=n[1]):n[0].length<=2&&(i.m=n[0],i.d=n[1])),e.push(i)}return e}}var l,h,c,d,u,p,v,f,m=0,g=0,y=!1,b=i("div",{"class":"calen-wrap"}),w=i("div",{"class":"calen-mask"}),D=i("div",{"class":"calen"}),x=i("div",{"class":"calen-list"});t.prototype.init=function(){var t=this,i=n(document,".calendars");if(i.length){document.body.appendChild(b),b.appendChild(w),b.appendChild(D),calenTitle=n(D,".calen-title"),this.createHeader(function(){t.createWeek(),D.appendChild(x),e(x,function(e,a){a>0?m--:m++,t.startJSON.prev.m=m-1,t.startJSON.now.m=m,t.startJSON.next.m=m+1,t.transitions(e,a)});for(var n=0;n<h.length;n++)h[n].onclick=function(){if(a(this,"calen-month-txt","has")){a(f,"active",f.show?"remove":"add"),v.show&&(a(v,"active","remove"),v.show=!1);for(var t=0;t<c.length;t++)c[t].getAttribute("data-value")==this.getAttribute("data-value")?a(c[t],"active"):a(c[t],"active","remove");f.show=!f.show}else if(a(this,"calen-year-txt","has")){a(v,"active",v.show?"remove":"add"),f.show&&(a(f,"active","remove"),f.show=!1);for(var t=0;t<d.length;t++)d[t].getAttribute("data-value")==this.getAttribute("data-value")?a(d[t],"active"):a(d[t],"active","remove");v.show=!v.show}}}),this.createDate({},function(e){for(var n=0;n<c.length;n++)e[n].onclick=function(){for(var n=0;n<e.length;n++)a(e[n],"active","remove");m+=this.getAttribute("data-value")-p.getAttribute("data-value"),t.appendList({},function(){t.addEvent()}),a(this,"active"),a(f,"active","remove"),v.show=!1,f.show=!1}});for(var s=0;s<i.length;s++)i[s].ontouchstart=i[s].onmousedown=function(){var n=Number(this.getAttribute("start"))||1915,i=Number(this.getAttribute("end"))||2020;l=!(null==this.getAttribute("past")),t.hours=!(null==this.getAttribute("hours")),t.hoursPast=!(null==this.getAttribute("hours-past")),t.shield=o(this.getAttribute("shield")||""),t.startDate=o(this.getAttribute("start-date")||"");var r,s,h,c=new Date;if(t.startDate instanceof Array&&t.startDate.length){var d=t.startDate[0];g=d.y-c.getFullYear(),m=d.m-(c.getMonth()+1),t.fixDate.y=d.y,t.fixDate.m=d.m,t.fixDate.d=d.d,r={y:g,m:m-1},s={y:g,m:m,d:d.d},h={y:g,m:m+1},t.startJSON={prev:r,now:s,next:h}}else t.fixDate.y=c.getFullYear(),t.fixDate.m=c.getMonth(),t.fixDate.d=c.getDate();return t.focusObj!=this&&((!t.startDate instanceof Array||!t.startDate)&&(m=0,g=0,t.startJSON.prev={y:g,m:m-1},t.startJSON.now={y:g,m:m},t.startJSON.next={y:g,m:m+1}),t.appendList(t.startJSON,function(){t.addEvent()}),t.createDate({start:n,end:i,type:"year"},function(n){for(var i=0;i<n.length;i++)n[i].onclick=function(){for(var e=0;e<n.length;e++)a(n[e],"active","remove");g+=this.getAttribute("data-value")-u.getAttribute("data-value"),t.appendList({},function(){t.addEvent()}),a(this,"active"),a(v,"active","remove"),v.show=!1,f.show=!1};e(v,function(t,e){v.index=v.index||0;var a=v.children.length;e>0?(v.index++,v.index>=0&&(v.index=0)):(v.index--,v.index<=-a&&(v.index=-(a-1)));var n="translateX("+v.index*(100/a)+"%)";v.style.WebkitTransform=n,v.style.transform=n,setTimeout(function(){y=!1},500)})})),a(b,"active"),t.focusObj=this,this.blur(),!1};D.onclick=function(t){var e=t.targetTouches?t.targetTouches[0]:t||event;e.cancelBubble=!0},w.onclick=r}},t.prototype.createCalenList=function(t,e){function n(e,a,n){if(!o.shield)return!1;for(var i=0;i<o.shield.length;i++)if(o.shield[i].y=o.shield[i].y||t.getFullYear(),o.shield[i].m=o.shield[i].m||t.getMonth()+1,o.shield[i].d=o.shield[i].d||t.getDate(),e==o.shield[i].y&&a==o.shield[i].m&&n==o.shield[i].d)return!0;return!1}var r=document.createElement("div"),s=0,o=this;t=t||{},t.m=t.m||0,t.y=t.y||0;var h=new Date,h=new Date,c=h.getDate();h.setFullYear(h.getFullYear()+t.y,h.getMonth()+t.m+1,1,0,0,0),h.setDate(0);var d=h.getDate();h.setDate(1);var v=h.getDay(),h=new Date;h.setFullYear(h.getFullYear()+t.y,h.getMonth()+t.m,1,0,0,0);var f=h.getMonth()+1,m=h.getFullYear();h.setDate(0);for(var g=h.getDate(),y=[],b=g;b>0;b--)y.push(b);e&&(u.innerHTML=m,p.innerHTML=10>f?"0"+f:f,u.setAttribute("data-value",m),p.setAttribute("data-value",f-1));var w=v+7;w=w>=10?w-7:w;for(var b=0;w>b;b++){var D=i("span"),x=i("a",{"data-calen":m+"/"+(f-1)+"/"+y[b],"class":"prev-m prev-to-month pasted",href:"javascript:;"},y[b]);y[b]!=c||1!=t.m||t.y||a(x,"today"),D.appendChild(x),r.children.length?r.insertBefore(D,r.children[0]):r.appendChild(D),s++}for(var b=0;d>b;b++){s++;var C=b+1,D=i("span"),x=i("a",{"data-calen":m+"/"+f+"/"+C,href:"javascript:;"},C);(s%7==1||s%7==0)&&(x.className="weekend"),t.m||t.y?l&&t.m<0&&t.y<=0&&(x.className=" expire pasted"):C==c?x.className=x.className+" today":c>C&&(x.className=x.className+" expire pasted"),(m<=o.fixDate.y&&f<=o.fixDate.m&&C<t.d||m<=o.fixDate.y&&f<o.fixDate.m)&&(a(x,"expire"),a(x,"pasted")),n(m,f,C)&&(a(x,"expire"),a(x,"pasted")),D.appendChild(x),r.appendChild(D)}for(var j=42-r.children.length,b=0;j>b;b++){var C=b+1,D=i("span"),x=i("a",{"data-calen":m+"/"+(f+1)+"/"+C,"class":"next-m next-to-month",href:"javascript:;"},C);C!=c||-1!=t.m||t.y||a(x,"today"),D.appendChild(x),r.appendChild(D)}return r},t.prototype.createDate=function(t,e){t=t||{},t.start=t.start||1,t.end=t.end||12,t.type=t.type||"month";for(var a=i("div",{"class":"month"==t.type?"calen-months":"calen-years"}),n=i("div"),r=[],s=0,o=0,l=0,h=(new Date).getFullYear(),u=t.start;u<=t.end;u++){var p=i("span"),m=i("a",{"data-value":"year"==t.type?u:u-1,href:"javascript:;"},10>u?"0"+u:u);r.push(m),"year"==t.type?(s>=12&&(a.appendChild(n),n=i("div"),s=0,o++),u==h&&(l=o),p.appendChild(m),n.appendChild(p)):(p.appendChild(m),a.appendChild(p)),s++}if("year"==t.type){v&&D&&D.removeChild(v),a.appendChild(n),v=a,d=r,s&&o++,a.style.width=100*o+"%";for(var u=0;o>u;u++)a.children[u].style.width=100/o+"%";a.style.WebkitTransform="translateX(-"+l*(100/o)+"%)",a.style.transform="translateX(-"+l*(100/o)+"%)",v.index=-l}else f&&D&&D.removeChild(f),f=a,c=r;D.appendChild(a),e&&e(r)},t.prototype.createTime=function(t,e,s,o){var l=n(D,".calen-time"),h=[],c=new Date,d=c.getDate(),u=c.getHours(),p=this;if(l.length){l=l[0];for(var v=n(l,"a"),f=0;f<v.length;f++)h.push({obj:v[f],time:parseInt(v[f].getAttribute("data-time"),10)})}else{l=i("div",{"class":"calen-time"});for(var f=0;24>f;f++){var y=10>f?"0"+f:f;y+=":00";var b=i("span"),w=i("a",{href:"javascript:;","data-time":y},y);b.appendChild(w),l.appendChild(b),h.push({obj:w,time:parseInt(y,10)})}}a(l,"active");for(var f=0;f<h.length;f++)p.hoursPast&&o&&(0>m&&0>=g||s==d&&h[f].time<=u)?(a(h[f].obj,"expire"),a(h[f].obj,"pasted"),h[f].obj.active=!1):(a(h[f].obj,"expire","remove"),a(h[f].obj,"pasted","remove"),h[f].obj.active=!0),function(n){h[f].obj.onclick=function(){if(this.active){var i=e+" "+(10>n?"0"+n:n)+":00";null!=t.value?t.value=i:null!=t.innerHTML&&(t.innerHTML=i),a(l,"active","remove"),r()}}}(h[f].time);D.appendChild(l)},t.prototype.createHeader=function(t){h=h||[];var e=this,n=i("div",{"class":"calen-header"}),r=i("div",{"class":"calen-year"}),s=i("a",{"class":"float-l year-prev switch-btn",href:"javascript:;"},"&lt;"),o=i("a",{"class":"float-r year-next switch-btn",href:"javascript:;"},"&gt;"),l=i("a",{"class":"calen-year-txt calen-title",href:"javascript:;"});r.appendChild(s),r.appendChild(l),r.appendChild(o);var c=i("div",{"class":"calen-month"}),d=i("a",{"class":"float-l month-prev switch-btn",href:"javascript:;"},"&lt;"),v=i("a",{"class":"float-r month-next switch-btn",href:"javascript:;"},"&gt;"),f=i("a",{"class":"calen-month-txt calen-title",href:"javascript:;"});c.appendChild(d),c.appendChild(f),c.appendChild(v),n.appendChild(r),n.appendChild(c),h.push(l,f),p=f,u=l,d.onclick=function(){e.switchDate(-1)},v.onclick=function(){e.switchDate(1)},s.onclick=function(){e.switchDate(-1,"year")},o.onclick=function(){e.switchDate(1,"year")},D.children.length?D.insertBefore(n,D.children[0]):D.appendChild(n);for(var m=0;m<n.children.length;m++)n.children[m].ontouchstart=function(){a(this,"active")},n.children[m].ontouchend=function(){a(this,"active","remove")};t&&t()},t.prototype.createWeek=function(){for(var t=i("div",{"class":"calen-week"}),e="日一二三四五六",a=0;7>a;a++){var n=a+1,r={};(n%7==1||n%7==0)&&(r["class"]="weekend"),t.appendChild(i("span",r,e.charAt(a)))}D.appendChild(t)},t.prototype.appendList=function(t,e){t=t||{},t.prev=t.prev||{m:m-1,y:g},t.now=t.now||{m:m,y:g},t.next=t.next||{m:m+1,y:g},x.innerHTML="",x.appendChild(this.createCalenList(t.prev)),x.appendChild(this.createCalenList(t.now,!0)),x.appendChild(this.createCalenList(t.next)),e&&e()},t.prototype.addEvent=function(){for(var t=this,e=x.getElementsByTagName("a"),n=0;n<e.length;n++)e[n].onclick=function(){if(a(this,"prev-to-month","has"))t.switchDate(-1);else if(a(this,"next-to-month","has"))t.switchDate(1);else if(!a(this,"pasted","has")||!l){var e=this.getAttribute("data-calen"),n=this.innerHTML;e=s(e,t.focusObj.getAttribute("format")||!1),t.hours?t.createTime(t.focusObj,e,n,l):(null!=t.focusObj.value&&(t.focusObj.value=e),null!=t.focusObj.innerHTML&&(t.focusObj.innerHTML=e),r())}}},t.prototype.switchDate=function(t,e){var a=this;switch(e=e||"month"){case"month":t>0?(m++,a.transitions(x,-1)):(m--,a.transitions(x,1));break;case"year":a.appendList({prev:{m:m,y:g-1},next:{m:m,y:g+1}},function(){t>0?(g++,a.transitions(x,-1)):(g--,a.transitions(x,1))})}},t.prototype.transitions=function(t,e){function n(){console.log(i.startJSON),i.appendList(i.startJSON,function(){a(t,"silde","remove"),a(t,"prev-to","remove"),a(t,"next-to","remove"),i.addEvent(),y=!1})}var i=this;e>0?(a(t,"silde"),a(t,"prev-to")):(a(t,"silde"),a(t,"next-to")),setTimeout(function(){n()},500)},window.addEventListener("load",function(){new t},!1)}();
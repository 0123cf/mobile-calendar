!function(){function e(){this.focusObj=null,this.init()}function t(e,t){function a(e){function a(e){var a=e.targetTouches?e.targetTouches[0]:e||event;return i=a.pageX-s,g?!1:(Math.abs(i)>=o&&(g=!0,t&&t(c,i)),a.preventDefault&&a.preventDefault(),!1)}function n(){this.ontouchmove&&(this.ontouchmove=null),this.ontouchend&&(this.ontouchend=null),this.onmousemove&&(this.onmousemove=null),this.onmouseup&&(this.onmouseup=null)}var i,r=e.targetTouches?e.targetTouches[0]:e||event,s=r.pageX,o=parseInt(document.documentElement.clientWidth/5,10),c=this;this.ontouchmove=a,this.onmousemove=a,this.ontouchend=n,this.onmouseup=n}e.ontouchstart=a,e.onmousedown=a}function a(e,t,a){if(t){var n=e.className.replace(/\s+/g," ");n=n.split(" "),t=t.replace(/\s+/,""),a=a||"add";for(var i=0;i<n.length;i++)switch(a){case"has":if(t==n[i])return!0;break;case"add":case"remove":t==n[i]&&n.splice(i,1)}"add"==a&&n.push(t),e.className=n.join(" ")}}function n(e,t){var a,n=t.charAt(0);switch(n){case"#":a=e.getElementById(t.substring(1));break;case".":a=e.getElementsByClassName(t.substring(1));break;default:a=e.getElementsByTagName(t)}return a}function i(e,t,a){if(e){t=t||{},a=a||"";var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);return n.innerHTML=a,n}}function r(){a(y,"close"),setTimeout(function(){a(y,"active","remove"),a(y,"close","remove")},290)}function s(e,t){if(!e)return!1;e=e.split("/"),t=t||"y/m/d";for(var a=t.charAt(0),n=0,i=0;i<t.length;i++)a.charAt(n)!=t.charAt(i)&&(a+=t.charAt(i),n++);var r={y:e[0],m:e[1],d:e[2]},s="",o="";/\//g.test(a)?s="/":/\-/g.test(a)&&(s="-"),a=a.split(s);for(var i=0;i<a.length;i++)o+=r[a[i]],i<a.length-1&&(o+=s);return o}var o,c,l,h,d,p,u,v,f=0,m=0,g=!1,y=i("div",{"class":"calen-wrap"}),w=i("div",{"class":"calen-mask"}),b=i("div",{"class":"calen"}),C=i("div",{"class":"calen-list"});e.prototype.init=function(){var e=this,i=n(document,".calendars");if(i.length){document.body.appendChild(y),y.appendChild(w),y.appendChild(b),calenTitle=n(b,".calen-title"),this.createHeader(function(){e.createWeek(),b.appendChild(C),t(C,function(t,a){a>0?f--:f++,e.transitions(t,a)});for(var n=0;n<c.length;n++)c[n].onclick=function(){if(a(this,"calen-month-txt","has")){a(v,"active",v.show?"remove":"add"),u.show&&(a(u,"active","remove"),u.show=!1);for(var e=0;e<l.length;e++)l[e].getAttribute("data-value")==this.getAttribute("data-value")?a(l[e],"active"):a(l[e],"active","remove");v.show=!v.show}else if(a(this,"calen-year-txt","has")){a(u,"active",u.show?"remove":"add"),v.show&&(a(v,"active","remove"),v.show=!1);for(var e=0;e<h.length;e++)h[e].getAttribute("data-value")==this.getAttribute("data-value")?a(h[e],"active"):a(h[e],"active","remove");u.show=!u.show}}}),this.createDate({},function(t){for(var n=0;n<l.length;n++)t[n].onclick=function(){for(var n=0;n<t.length;n++)a(t[n],"active","remove");f+=this.getAttribute("data-value")-p.getAttribute("data-value"),e.appendList({},function(){e.addEvent()}),a(this,"active"),a(v,"active","remove"),u.show=!1,v.show=!1}});for(var s=0;s<i.length;s++)i[s].ontouchstart=i[s].onmousedown=function(){var n=Number(this.getAttribute("start"))||1915,i=Number(this.getAttribute("end"))||2020;return o=!(null==this.getAttribute("past")),e.focusObj!=this&&(f=0,m=0,e.appendList({},function(){e.addEvent()}),e.createDate({start:n,end:i,type:"year"},function(n){for(var i=0;i<n.length;i++)n[i].onclick=function(){for(var t=0;t<n.length;t++)a(n[t],"active","remove");m+=this.getAttribute("data-value")-d.getAttribute("data-value"),e.appendList({},function(){e.addEvent()}),a(this,"active"),a(u,"active","remove"),u.show=!1,v.show=!1};t(u,function(e,t){u.index=u.index||0;var a=u.children.length;t>0?(u.index++,u.index>=0&&(u.index=0)):(u.index--,u.index<=-a&&(u.index=-(a-1)));var n="translateX("+u.index*(100/a)+"%)";u.style.WebkitTransform=n,u.style.transform=n,setTimeout(function(){g=!1},500)})})),a(y,"active"),e.focusObj=this,this.blur(),!1};b.onclick=function(e){var t=e.targetTouches?e.targetTouches[0]:e||event;t.cancelBubble=!0},w.onclick=r}},e.prototype.createCalenList=function(e,t){var n=document.createElement("div"),r=0;e=e||{},e.m=e.m||0,e.y=e.y||0;var s=new Date,c=s.getDate();s.setFullYear(s.getFullYear()+e.y,s.getMonth()+e.m+1,1,0,0,0),s.setDate(0);var l=s.getDate();s.setDate(1);var h=s.getDay(),s=new Date;s.setFullYear(s.getFullYear()+e.y,s.getMonth()+e.m,1,0,0,0);var u=s.getMonth()+1,v=s.getFullYear();s.setDate(0);for(var f=s.getDate(),m=[],g=f;g>0;g--)m.push(g);t&&(d.innerHTML=v,p.innerHTML=10>u?"0"+u:u,d.setAttribute("data-value",v),p.setAttribute("data-value",u-1));var y=h+7;y=y>=10?y-7:y;for(var g=0;y>g;g++){var w=i("span"),b=i("a",{"data-calen":v+"/"+(u-1)+"/"+m[g],"class":"prev-m prev-to-month pasted",href:"javascript:;"},m[g]);m[g]!=c||1!=e.m||e.y||a(b,"today"),w.appendChild(b),n.children.length?n.insertBefore(w,n.children[0]):n.appendChild(w),r++}for(var g=0;l>g;g++){r++;var C=g+1,w=i("span"),b=i("a",{"data-calen":v+"/"+u+"/"+C,href:"javascript:;"},C);(r%7==1||r%7==0)&&(b.className="weekend"),e.m||e.y?o&&e.m<0&&e.y<=0&&(b.className=" expire pasted"):C==c?b.className=b.className+" today":c>C&&(b.className=b.className+" expire pasted"),w.appendChild(b),n.appendChild(w)}for(var x=42-n.children.length,g=0;x>g;g++){var C=g+1,w=i("span"),b=i("a",{"data-calen":v+"/"+(u+1)+"/"+C,"class":"next-m next-to-month",href:"javascript:;"},C);C!=c||-1!=e.m||e.y||a(b,"today"),w.appendChild(b),n.appendChild(w)}return n},e.prototype.createDate=function(e,t){e=e||{},e.start=e.start||1,e.end=e.end||12,e.type=e.type||"month";for(var a=i("div",{"class":"month"==e.type?"calen-months":"calen-years"}),n=i("div"),r=[],s=0,o=0,c=0,d=(new Date).getFullYear(),p=e.start;p<=e.end;p++){var f=i("span"),m=i("a",{"data-value":"year"==e.type?p:p-1,href:"javascript:;"},10>p?"0"+p:p);r.push(m),"year"==e.type?(s>=12&&(a.appendChild(n),n=i("div"),s=0,o++),p==d&&(c=o),f.appendChild(m),n.appendChild(f)):(f.appendChild(m),a.appendChild(f)),s++}if("year"==e.type){u&&b&&b.removeChild(u),a.appendChild(n),u=a,h=r,s&&o++,a.style.width=100*o+"%";for(var p=0;o>p;p++)a.children[p].style.width=100/o+"%";a.style.WebkitTransform="translateX(-"+c*(100/o)+"%)",a.style.transform="translateX(-"+c*(100/o)+"%)",u.index=-c}else v&&b&&b.removeChild(v),v=a,l=r;b.appendChild(a),t&&t(r)},e.prototype.createHeader=function(e){c=c||[];var t=this,n=i("div",{"class":"calen-header"}),r=i("div",{"class":"calen-year"}),s=i("a",{"class":"float-l year-prev switch-btn",href:"javascript:;"},"&lt;"),o=i("a",{"class":"float-r year-next switch-btn",href:"javascript:;"},"&gt;"),l=i("a",{"class":"calen-year-txt calen-title",href:"javascript:;"});r.appendChild(s),r.appendChild(l),r.appendChild(o);var h=i("div",{"class":"calen-month"}),u=i("a",{"class":"float-l month-prev switch-btn",href:"javascript:;"},"&lt;"),v=i("a",{"class":"float-r month-next switch-btn",href:"javascript:;"},"&gt;"),f=i("a",{"class":"calen-month-txt calen-title",href:"javascript:;"});h.appendChild(u),h.appendChild(f),h.appendChild(v),n.appendChild(r),n.appendChild(h),c.push(l,f),p=f,d=l,u.onclick=function(){t.switchDate(-1)},v.onclick=function(){t.switchDate(1)},s.onclick=function(){t.switchDate(-1,"year")},o.onclick=function(){t.switchDate(1,"year")},b.children.length?b.insertBefore(n,b.children[0]):b.appendChild(n);for(var m=0;m<n.children.length;m++)n.children[m].ontouchstart=function(){a(this,"active")},n.children[m].ontouchend=function(){a(this,"active","remove")};e&&e()},e.prototype.createWeek=function(){for(var e=i("div",{"class":"calen-week"}),t="日一二三四五六",a=0;7>a;a++){var n=a+1,r={};(n%7==1||n%7==0)&&(r["class"]="weekend"),e.appendChild(i("span",r,t.charAt(a)))}b.appendChild(e)},e.prototype.appendList=function(e,t){e=e||{},e.prev=e.prev||{m:f-1,y:m},e.now=e.now||{m:f,y:m},e.next=e.next||{m:f+1,y:m},C.innerHTML="",C.appendChild(this.createCalenList(e.prev)),C.appendChild(this.createCalenList(e.now,!0)),C.appendChild(this.createCalenList(e.next)),t&&t()},e.prototype.addEvent=function(){for(var e=this,t=C.getElementsByTagName("a"),n=0;n<t.length;n++)t[n].onclick=function(){if(a(this,"prev-to-month","has"))e.switchDate(-1);else if(a(this,"next-to-month","has"))e.switchDate(1);else if(!a(this,"pasted","has")||!o){var t=this.getAttribute("data-calen");e.focusObj.value=s(t,e.focusObj.getAttribute("format")||!1),r()}}},e.prototype.switchDate=function(e,t){var a=this;switch(t=t||"month"){case"month":e>0?(f++,a.transitions(C,-1)):(f--,a.transitions(C,1));break;case"year":a.appendList({prev:{m:f,y:m-1},next:{m:f,y:m+1}},function(){e>0?(m++,a.transitions(C,-1)):(m--,a.transitions(C,1))})}},e.prototype.transitions=function(e,t){function n(){i.appendList({},function(){a(e,"silde","remove"),a(e,"prev-to","remove"),a(e,"next-to","remove"),i.addEvent(),g=!1})}var i=this;t>0?(a(e,"silde"),a(e,"prev-to")):(a(e,"silde"),a(e,"next-to")),setTimeout(function(){n()},500)},window.addEventListener("load",function(){new e},!1)}();
!function(t){var e="undefined"!=typeof window?window:this;"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e):function(e){if(!e.document)throw new Error("document is a undefined");return t(e)}:t(e)}(function(t){function e(){var t=new Date;this.hours=!1,this.hoursPast=!1,this.focusObj=null,this.shield="[]",this.startDate="",this.startJSON={},this.fixDate={y:t.getFullYear(),m:t.getMonth()+1,d:t.getDate()},this.init()}function a(t,e){function a(t){function a(t){var a=t.targetTouches?t.targetTouches[0]:t||event;return i=a.pageX-s,b?!1:(Math.abs(i)>=o&&(b=!0,e&&e(l,i)),a.preventDefault&&a.preventDefault(),!1)}function n(){this.ontouchmove&&(this.ontouchmove=null),this.ontouchend&&(this.ontouchend=null),this.onmousemove&&(this.onmousemove=null),this.onmouseup&&(this.onmouseup=null)}var i,r=t.targetTouches?t.targetTouches[0]:t||event,s=r.pageX,o=parseInt(document.documentElement.clientWidth/5,10),l=this;this.ontouchmove=a,this.onmousemove=a,this.ontouchend=n,this.onmouseup=n}t.ontouchstart=a,t.onmousedown=a}function n(t,e,a){if(e){var n=t.className.replace(/\s+/g," ");n=n.split(" "),e=e.replace(/\s+/,""),a=a||"add";for(var i=0;i<n.length;i++)switch(a){case"has":if(e==n[i])return!0;break;case"add":case"remove":e==n[i]&&n.splice(i,1)}"add"==a&&n.push(e),t.className=n.join(" ")}}function i(t,e){var a,n=e.charAt(0);switch(n){case"#":a=t.getElementById(e.substring(1));break;case".":a=t.getElementsByClassName(e.substring(1));break;default:a=t.getElementsByTagName(e)}return a}function r(t,e,a){if(t){e=e||{},a=a||"";var n=document.createElement(t);for(var i in e)n.setAttribute(i,e[i]);return n.innerHTML=a,n}}function s(){n(w,"close"),setTimeout(function(){n(w,"active","remove"),n(w,"close","remove")},290)}function o(t,e){if(!t)return!1;t=t.split("/"),e=e||"y/m/d";for(var a=e.charAt(0),n=0,i=0;i<e.length;i++)a.charAt(n)!=e.charAt(i)&&(a+=e.charAt(i),n++);var r={y:t[0],m:t[1],d:t[2]},s="",o="";/\//g.test(a)?s="/":/\-/g.test(a)&&(s="-"),a=a.split(s);for(var i=0;i<a.length;i++)o+=r[a[i]],i<a.length-1&&(o+=s);return o}function l(t){if(t=t.replace(/[\'\s]+/g,"")){t=t.match(/(\d+[\/\-]\d+[\/\-]\d+)/g);for(var e=[],a=0;a<t.length;a++){var n=t[a].match(/\d+/g),i={};3==n.length?(i.m=n[1],4==n[0].length?(i.y=n[0],i.d=n[2]):(i.d=n[0],i.y=n[2])):2==n.length&&(4==n[0].length?(i.y=n[0],i.m=n[1]):n[0].length<=2&&(i.m=n[0],i.d=n[1])),e.push(i)}return e}}var h,c,d,u,p,v,f,m,g=0,y=0,b=!1,w=r("div",{"class":"calen-wrap"}),x=r("div",{"class":"calen-mask"}),D=r("div",{"class":"calen"}),C=r("div",{"class":"calen-list"});return e.prototype.init=function(){var t=this,e=i(document,".calendars");if(e.length){document.body.appendChild(w),w.appendChild(x),w.appendChild(D),calenTitle=i(D,".calen-title"),this.createHeader(function(){t.createWeek(),D.appendChild(C),a(C,function(e,a){a>0?g--:g++,t.startJSON.prev.m=g-1,t.startJSON.now.m=g,t.startJSON.next.m=g+1,t.transitions(e,a)});for(var e=0;e<c.length;e++)c[e].onclick=function(){if(n(this,"calen-month-txt","has")){n(m,"active",m.show?"remove":"add"),f.show&&(n(f,"active","remove"),f.show=!1);for(var t=0;t<d.length;t++)d[t].getAttribute("data-value")==this.getAttribute("data-value")?n(d[t],"active"):n(d[t],"active","remove");m.show=!m.show}else if(n(this,"calen-year-txt","has")){n(f,"active",f.show?"remove":"add"),m.show&&(n(m,"active","remove"),m.show=!1);for(var t=0;t<u.length;t++)u[t].getAttribute("data-value")==this.getAttribute("data-value")?n(u[t],"active"):n(u[t],"active","remove");f.show=!f.show}}}),this.createDate({},function(e){for(var a=0;a<d.length;a++)e[a].onclick=function(){for(var a=0;a<e.length;a++)n(e[a],"active","remove");g+=this.getAttribute("data-value")-v.getAttribute("data-value"),t.startJSON.prev.m=g-1,t.startJSON.now.m=g,t.startJSON.next.m=g+1,t.appendList(t.startJSON,function(){t.addEvent()}),n(this,"active"),n(m,"active","remove"),f.show=!1,m.show=!1}});for(var r=0;r<e.length;r++)e[r].ontouchstart=e[r].onmousedown=function(){var e=Number(this.getAttribute("start"))||1915,i=Number(this.getAttribute("end"))||2020;h=!(null==this.getAttribute("past")),t.hours=!(null==this.getAttribute("hours")),t.hoursPast=!(null==this.getAttribute("hours-past")),t.shield=l(this.getAttribute("shield")||""),t.startDate=l(this.getAttribute("start-date")||"");var r,s,o,c=new Date;if(t.startDate instanceof Array&&t.startDate.length){var d=t.startDate[0];y=d.y-c.getFullYear(),g=d.m-(c.getMonth()+1),t.fixDate.y=d.y,t.fixDate.m=d.m,t.fixDate.d=d.d,r={y:y,m:g-1,d:d.d},s={y:y,m:g,d:d.d},o={y:y,m:g+1,d:d.d},t.startJSON={prev:r,now:s,next:o}}else t.fixDate.y=c.getFullYear(),t.fixDate.m=c.getMonth()+1,t.fixDate.d=c.getDate();return t.focusObj!=this&&((!t.startDate instanceof Array||!t.startDate)&&(g=0,y=0,t.startJSON.prev={y:y,m:g-1},t.startJSON.now={y:y,m:g},t.startJSON.next={y:y,m:g+1}),t.appendList(t.startJSON,function(){t.addEvent()}),t.createDate({start:e,end:i,type:"year"},function(e){for(var i=0;i<e.length;i++)e[i].onclick=function(){for(var a=0;a<e.length;a++)n(e[a],"active","remove");y+=this.getAttribute("data-value")-p.getAttribute("data-value"),t.startJSON.prev.y=y,t.startJSON.now.y=y,t.startJSON.next.y=y,t.appendList(t.startJSON,function(){t.addEvent()}),n(this,"active"),n(f,"active","remove"),f.show=!1,m.show=!1};a(f,function(t,e){f.index=f.index||0;var a=f.children.length;e>0?(f.index++,f.index>=0&&(f.index=0)):(f.index--,f.index<=-a&&(f.index=-(a-1)));var n="translateX("+f.index*(100/a)+"%)";f.style.WebkitTransform=n,f.style.transform=n,setTimeout(function(){b=!1},500)})})),n(w,"active"),t.focusObj=this,this.blur(),!1};D.onclick=function(t){var e=t.targetTouches?t.targetTouches[0]:t||event;e.cancelBubble=!0},x.onclick=s}},e.prototype.createCalenList=function(t,e){function a(e,a,n){if(!o.shield)return!1;for(var i=0;i<o.shield.length;i++)if(o.shield[i].y=o.shield[i].y||t.getFullYear(),o.shield[i].m=o.shield[i].m||t.getMonth()+1,o.shield[i].d=o.shield[i].d||t.getDate(),e==o.shield[i].y&&a==o.shield[i].m&&n==o.shield[i].d)return!0;return!1}var i=document.createElement("div"),s=0,o=this;t=t||{},t.m=t.m||0,t.y=t.y||0;var l=new Date,l=new Date,c=l.getDate();l.setFullYear(l.getFullYear()+t.y,l.getMonth()+t.m+1,1,0,0,0),l.setDate(0);var d=l.getDate();l.setDate(1);var u=l.getDay(),l=new Date;l.setFullYear(l.getFullYear()+t.y,l.getMonth()+t.m,1,0,0,0);var f=l.getMonth()+1,m=l.getFullYear();l.setDate(0);for(var g=l.getDate(),y=[],b=g;b>0;b--)y.push(b);e&&(p.innerHTML=m,v.innerHTML=10>f?"0"+f:f,p.setAttribute("data-value",m),v.setAttribute("data-value",f-1));var w=u+7;w=w>=10?w-7:w;for(var b=0;w>b;b++){var x=r("span"),D=r("a",{"data-calen":m+"/"+(f-1)+"/"+y[b],"class":"prev-m prev-to-month pasted",href:"javascript:;"},y[b]);(y[b]==c&&1==t.m&&!t.y&&!t.d||!t.y&&Number(o.fixDate.m)+1==f&&o.fixDate.d==y[b])&&n(D,"today"),a(m,f-1,y[b])&&(n(D,"pasted"),n(D,"shield")),x.appendChild(D),i.children.length?i.insertBefore(x,i.children[0]):i.appendChild(x),s++}for(var b=0;d>b;b++){s++;{var C=b+1,x=r("span"),D=r("a",{"data-calen":m+"/"+f+"/"+C,href:"javascript:;"},C);new Date}(s%7==1||s%7==0)&&(D.className="weekend"),!t.m&&!t.y||!t.y&&o.fixDate.m==f?o.fixDate.d==C||!o.fixDate.d&&C==c?D.className=D.className+" today":h&&c>C&&(D.className=D.className+" expire pasted"):h&&t.m<0&&t.y<=0&&(D.className=" expire pasted"),(m<=o.fixDate.y&&f<=o.fixDate.m&&C<t.d||m<=o.fixDate.y&&f<o.fixDate.m)&&o.startDate&&(n(D,"expire"),n(D,"pasted")),a(m,f,C)&&(n(D,"pasted"),n(D,"shield")),x.appendChild(D),i.appendChild(x)}for(var N=42-i.children.length,b=0;N>b;b++){var C=b+1,x=r("span"),D=r("a",{"data-calen":m+"/"+(f+1)+"/"+C,"class":"next-m next-to-month",href:"javascript:;"},C);(C==c&&-1==t.m&&!t.y&&!t.d||!t.y&&o.fixDate.m-1==f&&o.fixDate.d==C)&&n(D,"today"),a(m,f+1,C)&&(n(D,"pasted"),n(D,"shield")),x.appendChild(D),i.appendChild(x)}return i},e.prototype.createDate=function(t,e){t=t||{},t.start=t.start||1,t.end=t.end||12,t.type=t.type||"month";for(var a=r("div",{"class":"month"==t.type?"calen-months":"calen-years"}),n=r("div"),i=[],s=0,o=0,l=0,h=(new Date).getFullYear(),c=t.start;c<=t.end;c++){var p=r("span"),v=r("a",{"data-value":"year"==t.type?c:c-1,href:"javascript:;"},10>c?"0"+c:c);i.push(v),"year"==t.type?(s>=12&&(a.appendChild(n),n=r("div"),s=0,o++),c==h&&(l=o),p.appendChild(v),n.appendChild(p)):(p.appendChild(v),a.appendChild(p)),s++}if("year"==t.type){f&&D&&D.removeChild(f),a.appendChild(n),f=a,u=i,s&&o++,a.style.width=100*o+"%";for(var c=0;o>c;c++)a.children[c].style.width=100/o+"%";a.style.WebkitTransform="translateX(-"+l*(100/o)+"%)",a.style.transform="translateX(-"+l*(100/o)+"%)",f.index=-l}else m&&D&&D.removeChild(m),m=a,d=i;D.appendChild(a),e&&e(i)},e.prototype.createTime=function(t,e,a,o){var l=i(D,".calen-time"),h=[],c=new Date,d=c.getDate(),u=c.getHours(),p=this;if(l.length){l=l[0];for(var v=i(l,"a"),f=0;f<v.length;f++)h.push({obj:v[f],time:parseInt(v[f].getAttribute("data-time"),10)})}else{l=r("div",{"class":"calen-time"});for(var f=0;24>f;f++){var m=10>f?"0"+f:f;m+=":00";var b=r("span"),w=r("a",{href:"javascript:;","data-time":m},m);b.appendChild(w),l.appendChild(b),h.push({obj:w,time:parseInt(m,10)})}}n(l,"active");for(var f=0;f<h.length;f++)p.hoursPast&&(0>g&&0>=y||a==d&&h[f].time<=u||0>=g&&0>=y&&d>a)?(n(h[f].obj,"expire"),n(h[f].obj,"pasted"),h[f].obj.active=!1):(n(h[f].obj,"expire","remove"),n(h[f].obj,"pasted","remove"),h[f].obj.active=!0),function(a){h[f].obj.onclick=function(){if(this.active){var i=e+" "+(10>a?"0"+a:a)+":00";null!=t.value?t.value=i:null!=t.innerHTML&&(t.innerHTML=i),s()}n(l,"active","remove")}}(h[f].time);D.appendChild(l)},e.prototype.createHeader=function(t){c=c||[];var e=this,a=r("div",{"class":"calen-header"}),i=r("div",{"class":"calen-year"}),s=r("a",{"class":"float-l year-prev switch-btn",href:"javascript:;"},"&lt;"),o=r("a",{"class":"float-r year-next switch-btn",href:"javascript:;"},"&gt;"),l=r("a",{"class":"calen-year-txt calen-title",href:"javascript:;"});i.appendChild(s),i.appendChild(l),i.appendChild(o);var h=r("div",{"class":"calen-month"}),d=r("a",{"class":"float-l month-prev switch-btn",href:"javascript:;"},"&lt;"),u=r("a",{"class":"float-r month-next switch-btn",href:"javascript:;"},"&gt;"),f=r("a",{"class":"calen-month-txt calen-title",href:"javascript:;"});h.appendChild(d),h.appendChild(f),h.appendChild(u),a.appendChild(i),a.appendChild(h),c.push(l,f),v=f,p=l,d.onclick=function(){e.switchDate(-1)},u.onclick=function(){e.switchDate(1)},s.onclick=function(){e.switchDate(-1,"year")},o.onclick=function(){e.switchDate(1,"year")},D.children.length?D.insertBefore(a,D.children[0]):D.appendChild(a);for(var m=0;m<a.children.length;m++)a.children[m].ontouchstart=function(){n(this,"active")},a.children[m].ontouchend=function(){n(this,"active","remove")};t&&t()},e.prototype.createWeek=function(){for(var t=r("div",{"class":"calen-week"}),e="日一二三四五六",a=0;7>a;a++){var n=a+1,i={};(n%7==1||n%7==0)&&(i["class"]="weekend"),t.appendChild(r("span",i,e.charAt(a)))}D.appendChild(t)},e.prototype.appendList=function(t,e){t=t||{},t.prev=t.prev||{m:g-1,y:y},t.now=t.now||{m:g,y:y},t.next=t.next||{m:g+1,y:y},C.innerHTML="",C.appendChild(this.createCalenList(t.prev)),C.appendChild(this.createCalenList(t.now,!0)),C.appendChild(this.createCalenList(t.next)),e&&e()},e.prototype.addEvent=function(){for(var t=this,e=C.getElementsByTagName("a"),a=0;a<e.length;a++)e[a].onclick=function(){if(n(this,"prev-to-month","has"))t.switchDate(-1);else if(n(this,"next-to-month","has"))t.switchDate(1);else if(!n(this,"pasted","has")&&!n(this,"shield","has")){var e=this.getAttribute("data-calen"),a=this.innerHTML;e=o(e,t.focusObj.getAttribute("format")||!1),t.hours?t.createTime(t.focusObj,e,a,h):(null!=t.focusObj.value&&(t.focusObj.value=e),null!=t.focusObj.innerHTML&&(t.focusObj.innerHTML=e),s())}}},e.prototype.switchDate=function(t,e){var a=this;switch(e=e||"month"){case"month":t>0?g++:g--,a.startJSON.prev.m=g-1,a.startJSON.now.m=g,a.startJSON.next.m=g+1,a.transitions(C,t>0?-1:1);break;case"year":a.appendList({prev:{m:g,y:y-1},next:{m:g,y:y+1}},function(){t>0?y++:y--,a.startJSON.prev.y=y,a.startJSON.now.y=y,a.startJSON.next.y=y,a.transitions(C,t>0?-1:1)})}},e.prototype.transitions=function(t,e){function a(){i.appendList(i.startJSON,function(){n(t,"silde","remove"),n(t,"prev-to","remove"),n(t,"next-to","remove"),i.addEvent(),b=!1})}var i=this;e>0?(n(t,"silde"),n(t,"prev-to")):(n(t,"silde"),n(t,"next-to")),setTimeout(function(){console.log(i.startJSON),a()},500)},t.addEventListener("load",function(){new e},!1),e});